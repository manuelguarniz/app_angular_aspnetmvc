(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{F9DZ:function(t,e,o){"use strict";o.r(e),o.d(e,"ISolicitudAccesoModule",(function(){return me}));var i=o("ofXK"),a=o("tyNb"),c=o("0EQZ"),n=o("fXoL"),r=o("M9IT"),l=o("Dh3D"),s=o("+0xr"),d=o("RrUJ"),b=function(t){return t.SPECIAL_SOLICIUD_ACCESO="67",t}({}),u=o("Bzqt");const p=["select","id","empresa","trabajador.NOANX","departamento.nombre","puntoControl.nombre","estado","action"];var m=function(t){return t[t.SolicitudAprobada=5]="SolicitudAprobada",t[t.Anulado=6]="Anulado",t}({}),h=o("LAY5"),g=o("XNiG"),f=o("1G5W"),C=o("0IaG"),S=o("4E86");let v=(()=>{class t{constructor(t){this.appSetting=t}nivelActualSolicitud(t,e,o){let i=0;return o?i=3:e?i=2:t&&(i=1),i}obtenerNivelEspecial(){let t=[];const e=this.appSetting.optionsSpecialAccess;if(e&&e.length){const o=e.filter(t=>t.TIPO_MOV_ADICIONAL&&t.TIPO_MOV.trim()===b.SPECIAL_SOLICIUD_ACCESO);o&&o.length&&(t=o.map(t=>isNaN(+(null==t?void 0:t.ESPECIAL_ID))?0:+t.ESPECIAL_ID))}return t}}return t.\u0275fac=function(e){return new(e||t)(n.Zb(S.a))},t.\u0275prov=n.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var A=o("tk/3"),I=o("Oj5W"),V=o("AytR"),O=o("M5Uu"),U=o("A2WV"),j=o("EIzb");let P=(()=>{class t extends U.a{constructor(t,e,o){super(t,e),this.http=t,this.alertModalService=e,this.appSetting=o,this.$api=V.a.baseUrl}obtenerSolicitudesDeAcceso(t){const e=Object.assign({},t);e.departamentoId=t.departamentoId||"@",e.puntoControlId=t.puntoControlId||"@",this.appSetting.isIntranet?(e.proveedorId=t.proveedorId||"@",e.niveles=t.niveles||"@"):(e.proveedorId=this.appSetting.proveedorId,e.niveles="@");const o=this.appSetting.isIntranet?this.appSetting.currentUser:"@";let i=`${this.$api}${O.a.SOLICITUD_ACCESOS_LISTAR}?ProveedorId=${e.proveedorId}&niveles=${e.niveles}`;i=i.concat(`&departamentoId=${e.departamentoId}&puntoControlId=${e.puntoControlId}`),i=i.concat("&usuario="+o);const a=new A.d;return this.getMethod(i,a,I.a.formatRequestSolicitudAccesoList)}obtenerSolicitudesDeAccesoById(t){const e=`${this.$api}${O.a.SOLICITUD_ACCESOS}/${t}`,o=new A.d;return this.getMethod(e,o,I.a.formatRequestSolicitudAcceso)}upsertSolicitudesDeAcceso(t){return t.id?this.updateSolicitudAcceso(t):this.insertSolicitudAcceso(t)}updateSolicitudAcceso(t){const e=`${this.$api}${O.a.SOLICITUD_ACCESOS}/${t.id}`,o=I.a.formatResponseSolicitudPersonalInsert(t);return o.Operador=this.appSetting.currentUser,this.postMethod(e,o)}insertSolicitudAcceso(t){const e=`${this.$api}${O.a.SOLICITUD_ACCESOS_AGREGAR}`,o=I.a.formatResponseSolicitudPersonalInsert(t);return o.Operador_ID=this.appSetting.currentUser,this.postMethod(e,o)}insertMasivoSolicitudAcceso(t){const e=`${this.$api}${O.a.SOLICITUD_ACCESOS_AGREGAR_MASIVO}`,o=I.a.formatResponseSolicitudAcceso(t);return o.usuario=this.appSetting.currentUser,this.postMethod(e,o)}anularSolicitud(t){return this.postMethod(`${this.$api}${O.a.SOLICITUD_ACCESOS_ANULAR}/${t}/${this.appSetting.currentUser}`,{})}aprobarSolicitud(t,e){return this.postMethod(`${this.$api}${O.a.SOLICITUD_ACCESOS_APROBAR}/${t}/${this.appSetting.currentUser}/${e}`,{})}obtenerSerializadoFormatoImportacion(){return this.getMethodDownloadFile(`${this.$api}${O.a.SOLICITUD_ACCESOS_GENERAR_EXCEL}/${this.appSetting.isIntranet?"@":this.appSetting.proveedorId}`)}importMasivoSolicitudAcceso(t){const e=`${this.$api}${O.a.SOLICITUD_ACCESOS_IMPORT}`,o=I.a.formatResponseSolicitudesImportList(t,this.appSetting.currentUser);return this.postMethod(e,o)}notificarSolicitud(t){return this.postMethod(`${this.$api}${O.a.SOLICITUD_ACCESOS_NOTIFICAR}/${t}/${this.appSetting.currentUser}`,{})}}return t.\u0275fac=function(e){return new(e||t)(n.Zb(A.b),n.Zb(j.a),n.Zb(S.a))},t.\u0275prov=n.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var x=o("bTqV"),w=o("Qu3c"),_=o("NFeN"),F=o("kmnG"),y=o("f0Cb");function T(t,e){if(1&t&&(n.Vb(0,"mat-hint",8),n.Ic(1),n.Ub()),2&t){const t=n.hc().$implicit;n.Gb("spinner",t.loading),n.Cb(1),n.Jc(t.message)}}const M=function(t,e,o){return{"text-danger":t,"boton-amarillo":e,"text-success":o}};function k(t,e){if(1&t&&(n.Vb(0,"li",4),n.Vb(1,"section",5),n.Vb(2,"mat-icon",6),n.Ic(3),n.Ub(),n.Vb(4,"strong"),n.Ic(5),n.Ub(),n.Vb(6,"span"),n.Vb(7,"strong"),n.Ic(8," Solicitante:"),n.Ub(),n.Ic(9),n.Vb(10,"strong"),n.Ic(11," Punto de control:"),n.Ub(),n.Ic(12),n.Ub(),n.Gc(13,T,2,3,"mat-hint",7),n.Ub(),n.Ub()),2&t){const t=e.$implicit,o=e.index;n.Cb(1),n.pc("id","item_",o,""),n.Cb(1),n.nc("ngClass",n.tc(7,M,!t.loading&&!t.success,t.loading,!t.loading&&t.success)),n.Cb(1),n.Jc(t.icon),n.Cb(2),n.Kc("",o+1,". "),n.Cb(4),n.Kc(" ",t.solicitud.trabajador.NOANX,", "),n.Cb(3),n.Kc(" ",t.solicitud.puntoControl.nombre," "),n.Cb(1),n.nc("ngIf",!t.success)}}let E=(()=>{class t{constructor(t,e,o,i,a){this.dialogRef=t,this.data=e,this.cSolicitudAccesoValidationService=o,this.iSolicitudAccesoService=i,this.alertModalService=a,this.title="Aprobaci\xf3n multiple",this.itemsEvaluate=[],this.unsubscribe$=new g.a}ngOnInit(){var t;(null===(t=this.data)||void 0===t?void 0:t.accionAprobacion)?this.aprobacion():this.anulacion()}ngOnDestroy(){this.unsubscribe$.complete(),this.unsubscribe$.unsubscribe()}aprobacion(){this.itemsEvaluate=this.data.items.map(t=>({solicitud:t,icon:"schedule",loading:!0}));let t=0;for(const e of this.itemsEvaluate){const o=this.getNivelRequeridoAprobacionSolicitud(e.solicitud);e.loading=!0,this.iSolicitudAccesoService.aprobarSolicitud(e.solicitud.id,o).pipe(Object(f.a)(this.unsubscribe$)).subscribe(o=>{e.loading=!1,o?(t++,e.icon="check_circle_outline",e.success=!0,this.itemsEvaluate.length===t&&this.alertModalService.alert(h.a.success,"Se aprobar\xf3n las solicitudes con \xe9xito.")):(e.message="No se logro aprobar la solicitud, revise que cuente con el permisos correspondiente.",e.icon="cancel")})}}anulacion(){this.itemsEvaluate=this.data.items.map(t=>({solicitud:t,icon:"schedule",loading:!0}));let t=0;for(const e of this.itemsEvaluate)e.loading=!0,this.iSolicitudAccesoService.anularSolicitud(e.solicitud.id).pipe(Object(f.a)(this.unsubscribe$)).subscribe(o=>{e.loading=!1,o?(t++,e.icon="check_circle_outline",e.success=!0,this.itemsEvaluate.length===t&&this.alertModalService.alert(h.a.success,"Se anular\xf3n las solicitudes con \xe9xito.")):(e.message="No se logro anular la solicitud, vuelva a intentarlo.",e.icon="cancel")})}getNivelRequeridoAprobacionSolicitud(t){let e=this.cSolicitudAccesoValidationService.nivelActualSolicitud(t.aprobacionJefeSolicita,t.aprobacionResponsablePuntoControl,t.aprobacionJefedepartamento);return e++,e}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(C.g),n.Pb(C.a),n.Pb(v),n.Pb(P),n.Pb(j.a))},t.\u0275cmp=n.Jb({type:t,selectors:[["pca-preview-flujo-aprobacion-multiple"]],decls:13,vars:3,consts:[["mat-dialog-title",""],["mat-flat-button","","matTooltip","CERRAR",3,"mat-dialog-close"],[1,"mt-3"],["style","list-style: none;",4,"ngFor","ngForOf"],[2,"list-style","none"],[2,"display","flex","align-items","center",3,"id"],[1,"icon-absolute",3,"ngClass"],["style","display: block","class","text-danger",3,"spinner",4,"ngIf"],[1,"text-danger",2,"display","block"]],template:function(t,e){1&t&&(n.Vb(0,"h1",0),n.Ic(1),n.Ub(),n.Vb(2,"mat-dialog-actions"),n.Vb(3,"button",1),n.Vb(4,"mat-icon"),n.Ic(5,"arrow_back"),n.Ub(),n.Ub(),n.Vb(6,"mat-hint"),n.Ic(7,"* Al cerrar la ventana se actualizara la lista de solicitudes"),n.Ub(),n.Ub(),n.Qb(8,"mat-divider",2),n.Vb(9,"mat-dialog-content"),n.Qb(10,"br"),n.Vb(11,"ul"),n.Gc(12,k,14,11,"li",3),n.Ub(),n.Ub()),2&t&&(n.Cb(1),n.Jc(e.title),n.Cb(2),n.nc("mat-dialog-close",!0),n.Cb(9),n.nc("ngForOf",e.itemsEvaluate))},directives:[C.h,C.c,x.b,w.a,C.d,_.a,F.e,y.a,C.e,i.l,i.k,i.m],styles:[""]}),t})();var D=o("mrSG"),R=o("XKlN");let $=(()=>{class t{constructor(t){t&&Object.assign(this,t)}agregarPuntoControl(t){this.puntoControles||(this.puntoControles=[]),this.puntoControles.push(t),this.lengthPuntoControles=0===this.puntoControles.length?null:this.puntoControles.length}agregarTrabajador(t){this.puntoControles||(this.puntoControles=[]),this.puntoControles.push(t),this.lengthPuntoControles=0===this.puntoControles.length?null:this.puntoControles.length}}return Object(D.b)([Object(R.e)()],t.prototype,"anio",void 0),Object(D.b)([Object(R.e)()],t.prototype,"ciaId",void 0),Object(D.b)([Object(R.e)(),Object(R.f)({message:"* Campo obligatorio."})],t.prototype,"fechaInicio",void 0),Object(D.b)([Object(R.e)(),Object(R.f)({message:"* Campo obligatorio."})],t.prototype,"fechaFin",void 0),Object(D.b)([Object(R.e)()],t.prototype,"estadoId",void 0),Object(D.b)([Object(R.e)()],t.prototype,"motivo",void 0),Object(D.b)([Object(R.e)(),Object(R.f)({message:"* Campo obligatorio."})],t.prototype,"proveedorId",void 0),Object(D.b)([Object(R.e)(),Object(R.f)({message:"* Obligatorio para restringir los puntos de control."})],t.prototype,"uProduccion",void 0),Object(D.b)([Object(R.e)(),Object(R.f)({message:"* Campo obligatorio."})],t.prototype,"departamenteoId",void 0),Object(D.b)([Object(R.e)()],t.prototype,"fechaEfectiva",void 0),Object(D.b)([Object(R.e)()],t.prototype,"FECHA_APROB_JEF_SOLICITA_ID",void 0),Object(D.b)([Object(R.e)()],t.prototype,"FECHA_APROB_REF_PUNTO",void 0),Object(D.b)([Object(R.e)()],t.prototype,"FECHA_APROB_JEF_DPTO",void 0),Object(D.b)([Object(R.e)()],t.prototype,"FECHA_ANULA",void 0),Object(D.b)([Object(R.e)()],t.prototype,"puntoControles",void 0),Object(D.b)([Object(R.e)(),Object(R.f)({message:"* Campo obligatorio."})],t.prototype,"lengthPuntoControles",void 0),Object(D.b)([Object(R.e)()],t.prototype,"Trabajadores",void 0),Object(D.b)([Object(R.e)(),Object(R.f)({message:"* Campo obligatorio."})],t.prototype,"lengthTrabajadoes",void 0),t})();var N=o("lJxs"),G=o("7mxs"),L=o("Mdhe"),H=o("EHkv"),J=o("3Pt+"),Q=o("zkoq"),B=o("kngR"),q=o("M2k1"),K=o("V4Kw"),z=o("qFsG"),W=o("iadO"),X=o("vxfF"),Z=o("bSwM"),Y=o("CL+/"),tt=o("QibW"),et=o("Xa2L");function ot(t,e){if(1&t&&(n.Vb(0,"mat-grid-list",8),n.Vb(1,"mat-radio-group",34),n.Vb(2,"mat-grid-tile",9),n.Qb(3,"label",35),n.Ub(),n.Vb(4,"mat-grid-tile",9),n.Vb(5,"div",10),n.Vb(6,"mat-radio-button",36),n.Ic(7,"Trabajador"),n.Ub(),n.Vb(8,"mat-radio-button",37),n.Ic(9,"Visita"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub()),2&t){const t=n.hc();n.nc("rowHeight",t.platformService.heightMatColumns()),n.Cb(2),n.nc("colspan",1),n.Cb(2),n.nc("colspan",4)}}function it(t,e){1&t&&(n.Vb(0,"div",38),n.Qb(1,"mat-progress-spinner",39),n.Ub())}function at(t,e){if(1&t){const t=n.Wb();n.Vb(0,"div",40),n.Vb(1,"section",27),n.Vb(2,"mat-checkbox",41),n.dc("click",(function(e){return n.Ac(t),e.stopPropagation()}))("change",(function(e){n.Ac(t);const o=n.hc();return e?o.changeValueSolicitante(e):null})),n.Ub(),n.Vb(3,"label",42),n.Ic(4),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=e.$implicit,o=n.hc();n.nc("id","item_"+t.trab_id),n.Cb(2),n.nc("checked",o.selectionTrabajador.isSelected(t.trab_id))("aria-label",o.checkboxLabelTrabajador(t.trab_id))("value",t.trab_id),n.Cb(2),n.Lc("",t.Apellidos," ",t.Nombre,"")}}function ct(t,e){1&t&&(n.Vb(0,"div",38),n.Qb(1,"mat-progress-spinner",39),n.Ub())}function nt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"div",40),n.Vb(1,"section",27),n.Vb(2,"mat-checkbox",41),n.dc("click",(function(e){return n.Ac(t),e.stopPropagation()}))("change",(function(e){n.Ac(t);const o=n.hc();return e?o.changeValuePuntoControl(e):null})),n.Ub(),n.Vb(3,"label",42),n.Ic(4),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=e.$implicit,o=n.hc();n.nc("id","item_pc_"+t.id),n.Cb(2),n.nc("checked",o.selectionPuntoControl.isSelected(t.id))("aria-label",o.checkboxLabelPuntoControl(t.id))("value",t.id),n.Cb(2),n.Jc(t.nombre)}}let rt=(()=>{class t{constructor(t,e,o,i,a,n,r,l){this.dialogRef=t,this.fb=e,this.caTrabajadorService=o,this.caPuntoControlService=i,this.iSolicitudAccesoService=a,this.alertModalService=n,this.platformService=r,this.appSettings=l,this.trabajadores=[],this.loadingTrabajdores=!1,this.puntosControl=[],this.loadingPuntosControl=!1,this.puntoControlTextSelected="",this.unsubscribe$=new g.a,this.loadingSave=!1,this.filteredTrabajador=[],this.selectionTrabajador=new c.c(!0,[]),this.filteredPuntoControl=[],this.selectionPuntoControl=new c.c(!0,[])}ngOnInit(){this.formBuilderSolicitudAcceso()}outputValueTrabajador(t){t=(t||"").toUpperCase();const e=this.trabajadores.filter(e=>-1!==`${e.Apellidos} ${e.Nombre}`.toUpperCase().indexOf(t));this.filteredTrabajador=e||[]}ouputValuePuntoControl(t){t=(t||"").toUpperCase();const e=this.puntosControl.filter(e=>-1!==e.nombre.toUpperCase().indexOf(t));this.filteredPuntoControl=e||[]}ngOnDestroy(){this.unsubscribe$.complete(),this.unsubscribe$.unsubscribe()}formBuilderSolicitudAcceso(){this.formSolicitudMasivo=this.fb.formGroup(new $),this.appSettings.isIntranet||this.formSolicitudMasivo.get("proveedorId").setValue(this.appSettings.proveedorId)}closeForm(){this.dialogRef.close()}departamentoSelected(t){this.formSolicitudMasivo.get("fechaEfectiva").setValue((null==t?void 0:t.fechaEfectiva)||null),this.obtenerPuntoControl()}uProduccionSelected(t){t?(this.puntoControlTextSelected=t.nombre,this.obtenerPuntoControl()):(this.puntosControl=[],this.setFormControlValuePuntosControl([]))}empresaSelected(t){this.obtenerTrabajadores(null==t?void 0:t.proveedorId)}obtenerTrabajadores(t){this.trabajadores=[],this.filteredTrabajador=[],this.setFormControlValueTrabajador([]),t&&(this.loadingTrabajdores=!0,this.caTrabajadorService.obtenerTrabajdoresPorBusquedaTexto("",t).pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{this.loadingTrabajdores=!1,t&&t.length&&(this.trabajadores=t,this.filteredTrabajador=t||[])}))}obtenerPuntoControl(){const t=this.formSolicitudMasivo.get("uProduccion").value,e=this.formSolicitudMasivo.get("departamenteoId").value;this.puntosControl=[],this.filteredPuntoControl=[],t&&e&&(this.puntosControl=[],this.loadingPuntosControl=!0,this.caPuntoControlService.getListPuntoControlByUnidadProduccion(t,e).pipe(Object(f.a)(this.unsubscribe$),Object(N.a)(t=>t?t.filter(t=>!t.libreAcceso):t)).subscribe(t=>{this.loadingPuntosControl=!1,t&&t.length&&(this.puntosControl=t,this.filteredPuntoControl=t||[])}))}trackByTrabajadorFn(t,e){return null==e?void 0:e.trab_id}trackByPuntoControlFn(t,e){return null==e?void 0:e.id}save(){this.formSolicitudMasivo.valid?(this.loadingSave=!0,this.iSolicitudAccesoService.insertMasivoSolicitudAcceso(this.formSolicitudMasivo.value).pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{this.loadingSave=!1,t&&(this.alertModalService.alert(h.a.success,"Resgistro guardado con \xe9xito."),this.dialogRef.close(!0))})):this.alertModalService.alert(h.a.warning,"No se ha completado de ingresar todos los campos.")}isAllSelectedPuntoControl(){return this.selectionPuntoControl.selected.length===this.filteredPuntoControl.length}masterTogglePuntoControl(){this.isAllSelectedPuntoControl()?this.selectionPuntoControl.clear():this.filteredPuntoControl.forEach(t=>this.selectionPuntoControl.select(t.id));const t=(this.selectionPuntoControl.selected||[]).map(t=>({id:t}));this.setFormControlValuePuntosControl(t)}checkboxLabelPuntoControl(t){return t?`${this.selectionPuntoControl.isSelected(t)?"deselect":"select"} row ${t+1}`:(this.isAllSelectedPuntoControl()?"select":"deselect")+" all"}changeValuePuntoControl(t){this.selectionPuntoControl.toggle(+t.source.value);const e=this.formSolicitudMasivo.get("puntoControles").value||[],o={};if(o.id=+t.source.value,t.checked)e.push(o),this.setFormControlValuePuntosControl(e);else{const t=e.findIndex(t=>t.id===o.id);e.splice(t,1),this.setFormControlValuePuntosControl(e)}}setFormControlValuePuntosControl(t){this.formSolicitudMasivo.get("puntoControles").setValue(t),this.formSolicitudMasivo.get("lengthPuntoControles").setValue(0===t.length?null:t.length)}isAllSelectedTrabajador(){return this.selectionTrabajador.selected.length===this.filteredTrabajador.length}masterToggleTrabajador(){this.isAllSelectedTrabajador()?this.selectionTrabajador.clear():this.filteredTrabajador.forEach(t=>this.selectionTrabajador.select(t.trab_id));const t=(this.selectionTrabajador.selected||[]).map(t=>({set_id:V.a.cia_id,trab_id:t}));this.setFormControlValueTrabajador(t)}checkboxLabelTrabajador(t){return t?`${this.selectionTrabajador.isSelected(t)?"deselect":"select"} row ${t+1}`:(this.isAllSelectedTrabajador()?"select":"deselect")+" all"}changeValueSolicitante(t){this.selectionTrabajador.toggle(t.source.value);const e=this.formSolicitudMasivo.get("Trabajadores").value||[],o={};if(o.set_id=V.a.cia_id,o.trab_id=t.source.value,t.checked)e.push(o),this.setFormControlValueTrabajador(e);else{const t=e.findIndex(t=>t.trab_id===o.trab_id);e.splice(t,1),this.setFormControlValueTrabajador(e)}}setFormControlValueTrabajador(t){this.formSolicitudMasivo.get("Trabajadores").setValue(t),this.formSolicitudMasivo.get("lengthTrabajadoes").setValue(0===t.length?null:t.length)}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(C.g),n.Pb(R.a),n.Pb(G.a),n.Pb(L.a),n.Pb(P),n.Pb(j.a),n.Pb(H.a),n.Pb(S.a))},t.\u0275cmp=n.Jb({type:t,selectors:[["pca-registrar-acceso-masivo"]],decls:90,vars:48,consts:[[1,"add-title"],[1,"primary",2,"text-align","left"],[1,"example-form",3,"formGroup"],[1,"btn-sec"],["mat-raised-button","","matTooltip","GUARDAR",1,"margin-btn",3,"click"],[1,"material-icons"],["mat-raised-button","","matTooltip","ATRAS",1,"margin-btn",3,"click"],["cols","5",3,"rowHeight",4,"ngIf"],["cols","5",3,"rowHeight"],[3,"colspan"],[1,"label-align"],["formControlName","proveedorId",3,"required","readonly","empresaSelected"],["formControlName","departamenteoId",3,"required","departamentoSelected"],["formControlName","uProduccion",3,"required","uProduccionSelected"],["appearance","outline",1,"example-full-width","w-100"],["matInput","","formControlName","fechaInicio","readonly","",3,"max","matDatepicker"],["matSuffix","",3,"for"],["picker2",""],["matInput","","formControlName","fechaFin","readonly","",3,"min","matDatepicker"],["picker",""],["cols","6",3,"rowHeight"],[2,"max-height","50px","padding","5px !important",3,"colspan"],["cols","2",3,"rowHeight"],[1,"text-inside-grid"],["itemSize","5",1,"example-viewport"],[1,"row"],[1,"col-md-1","text-center","checkbox-small-padding"],[1,"example-section"],[3,"checked","indeterminate","aria-label","change"],[1,"col-md-8"],["autocomplete","false","name","busquedaTrabajdor",3,"label","ouputValue"],["class","container-spinner-loading",4,"ngIf"],["class","example-item",3,"id",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["autocomplete","false","name","busquedaPuntoControl",3,"label","ouputValue"],["id","radio","aria-labelledby","radio_tipo",1,"example-radio-group"],["id","radio_tipo",1,"label-align"],["value","1",1,"example-radio-button"],["value","2",1,"example-radio-button-r"],[1,"container-spinner-loading"],["color","primary","mode","indeterminate"],[1,"example-item",3,"id"],[1,"example-margin",3,"checked","aria-label","value","click","change"],[1,"p-left"]],template:function(t,e){if(1&t&&(n.Vb(0,"div"),n.Vb(1,"div",0),n.Vb(2,"h1",1),n.Ic(3,"Registro masivo de solicitudes de acceso"),n.Ub(),n.Qb(4,"mat-divider"),n.Ub(),n.Qb(5,"br"),n.Vb(6,"form",2),n.Vb(7,"div",3),n.Vb(8,"button",4),n.dc("click",(function(){return e.save()})),n.Vb(9,"span",5),n.Ic(10,"save"),n.Ub(),n.Ub(),n.Vb(11,"button",6),n.dc("click",(function(){return e.closeForm()})),n.Vb(12,"span",5),n.Ic(13,"arrow_back"),n.Ub(),n.Ub(),n.Ub(),n.Gc(14,ot,10,3,"mat-grid-list",7),n.Vb(15,"mat-grid-list",8),n.Vb(16,"mat-grid-tile",9),n.Vb(17,"label",10),n.Ic(18,"Empresa: "),n.Ub(),n.Ub(),n.Vb(19,"mat-grid-tile",9),n.Vb(20,"pca-autocomplete-empresa",11),n.dc("empresaSelected",(function(t){return e.empresaSelected(t)})),n.Ub(),n.Ub(),n.Ub(),n.Vb(21,"mat-grid-list",8),n.Vb(22,"mat-grid-tile",9),n.Vb(23,"label",10),n.Ic(24,"Dpto. Pto. Control: "),n.Ub(),n.Ub(),n.Vb(25,"mat-grid-tile",9),n.Vb(26,"pca-autocomplete-departamento",12),n.dc("departamentoSelected",(function(t){return e.departamentoSelected(t)})),n.Ub(),n.Ub(),n.Ub(),n.Vb(27,"mat-grid-list",8),n.Vb(28,"mat-grid-tile",9),n.Vb(29,"label",10),n.Ic(30,"U. Producci\xf3n: "),n.Ub(),n.Ub(),n.Vb(31,"mat-grid-tile",9),n.Vb(32,"pca-autocomplete-unidad-produccion",13),n.dc("uProduccionSelected",(function(t){return e.uProduccionSelected(t)})),n.Ub(),n.Ub(),n.Ub(),n.Vb(33,"mat-grid-list",8),n.Vb(34,"mat-grid-tile",9),n.Vb(35,"p",10),n.Ic(36,"* Fecha inicio:"),n.Ub(),n.Ub(),n.Vb(37,"mat-grid-tile",9),n.Vb(38,"mat-form-field",14),n.Vb(39,"mat-label"),n.Ic(40,"Fecha"),n.Ub(),n.Qb(41,"input",15),n.Qb(42,"mat-datepicker-toggle",16),n.Qb(43,"mat-datepicker",null,17),n.Ub(),n.Ub(),n.Vb(45,"mat-grid-tile",9),n.Vb(46,"p"),n.Ic(47,"* Fecha fin:"),n.Ub(),n.Ub(),n.Vb(48,"mat-grid-tile",9),n.Vb(49,"mat-form-field",14),n.Vb(50,"mat-label"),n.Ic(51,"Fecha"),n.Ub(),n.Qb(52,"input",18),n.Qb(53,"mat-datepicker-toggle",16),n.Qb(54,"mat-datepicker",null,19),n.Ub(),n.Ub(),n.Ub(),n.Vb(56,"mat-grid-list",20),n.Vb(57,"mat-grid-tile",21),n.Vb(58,"div",10),n.Ic(59,"* Solicitante: "),n.Ub(),n.Ub(),n.Vb(60,"mat-grid-tile",9),n.Vb(61,"div",10),n.Ic(62,"* Puntos de Control: "),n.Ub(),n.Ub(),n.Ub(),n.Vb(63,"mat-grid-list",22),n.Vb(64,"mat-grid-tile",9),n.Vb(65,"div",23),n.Vb(66,"cdk-virtual-scroll-viewport",24),n.Vb(67,"div",0),n.Vb(68,"div",25),n.Vb(69,"div",26),n.Vb(70,"section",27),n.Vb(71,"mat-checkbox",28),n.dc("change",(function(t){return t?e.masterToggleTrabajador():null})),n.Ub(),n.Ub(),n.Ub(),n.Vb(72,"div",29),n.Vb(73,"pca-input-generic",30),n.dc("ouputValue",(function(t){return e.outputValueTrabajador(t)})),n.Ub(),n.Ub(),n.Ub(),n.Qb(74,"mat-divider"),n.Ub(),n.Gc(75,it,2,0,"div",31),n.Gc(76,at,5,6,"div",32),n.Ub(),n.Ub(),n.Ub(),n.Vb(77,"mat-grid-tile",9),n.Vb(78,"div",23),n.Vb(79,"cdk-virtual-scroll-viewport",24),n.Vb(80,"div",0),n.Vb(81,"div",25),n.Vb(82,"div",26),n.Vb(83,"section",27),n.Vb(84,"mat-checkbox",28),n.dc("change",(function(t){return t?e.masterTogglePuntoControl():null})),n.Ub(),n.Ub(),n.Ub(),n.Vb(85,"div",29),n.Vb(86,"pca-input-generic",33),n.dc("ouputValue",(function(t){return e.ouputValuePuntoControl(t)})),n.Ub(),n.Ub(),n.Ub(),n.Qb(87,"mat-divider"),n.Ub(),n.Gc(88,ct,2,0,"div",31),n.Gc(89,nt,5,5,"div",32),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub()),2&t){const t=n.xc(44),o=n.xc(55);n.Cb(6),n.nc("formGroup",e.formSolicitudMasivo),n.Cb(2),n.Gb("spinner",e.loadingSave),n.Cb(6),n.nc("ngIf",!1),n.Cb(1),n.nc("rowHeight",e.platformService.heightMatColumns()),n.Cb(1),n.nc("colspan",1),n.Cb(3),n.nc("colspan",4),n.Cb(1),n.nc("required",!0)("readonly",!e.appSettings.isIntranet),n.Cb(1),n.nc("rowHeight",e.platformService.heightMatColumns()),n.Cb(1),n.nc("colspan",1),n.Cb(3),n.nc("colspan",4),n.Cb(1),n.nc("required",!0),n.Cb(1),n.nc("rowHeight",e.platformService.heightMatColumns()),n.Cb(1),n.nc("colspan",1),n.Cb(3),n.nc("colspan",4),n.Cb(1),n.nc("required",!0),n.Cb(1),n.nc("rowHeight",e.platformService.heightMatColumns()),n.Cb(1),n.nc("colspan",1),n.Cb(3),n.nc("colspan",1),n.Cb(4),n.nc("max",e.formSolicitudMasivo.get("fechaFin").value||null)("matDatepicker",t),n.Cb(1),n.nc("for",t),n.Cb(3),n.nc("colspan",1),n.Cb(3),n.nc("colspan",1),n.Cb(4),n.nc("min",e.formSolicitudMasivo.get("fechaInicio").value||null)("matDatepicker",o),n.Cb(1),n.nc("for",o),n.Cb(3),n.nc("rowHeight","2:1"),n.Cb(1),n.nc("colspan",3),n.Cb(3),n.nc("colspan",3),n.Cb(3),n.nc("rowHeight","2:1"),n.Cb(1),n.nc("colspan",1),n.Cb(7),n.nc("checked",e.selectionTrabajador.hasValue()&&e.isAllSelectedTrabajador())("indeterminate",e.selectionTrabajador.hasValue()&&!e.isAllSelectedTrabajador())("aria-label",e.checkboxLabelTrabajador()),n.Cb(2),n.nc("label","Buscar Trabajador"),n.Cb(2),n.nc("ngIf",e.loadingTrabajdores),n.Cb(1),n.nc("cdkVirtualForOf",e.filteredTrabajador)("cdkVirtualForTrackBy",e.trackByTrabajadorFn),n.Cb(1),n.nc("colspan",1),n.Cb(7),n.nc("checked",e.selectionPuntoControl.hasValue()&&e.isAllSelectedPuntoControl())("indeterminate",e.selectionPuntoControl.hasValue()&&!e.isAllSelectedPuntoControl())("aria-label",e.checkboxLabelPuntoControl()),n.Cb(2),n.nc("label","Buscar Punto Control"),n.Cb(2),n.nc("ngIf",e.loadingPuntosControl),n.Cb(1),n.nc("cdkVirtualForOf",e.filteredPuntoControl)("cdkVirtualForTrackBy",e.trackByPuntoControlFn)}},directives:[y.a,J.w,J.q,J.j,R.g,x.b,w.a,i.m,Q.a,Q.c,B.a,J.p,J.h,R.k,R.h,J.u,q.a,K.a,F.b,F.f,z.b,J.c,W.b,W.d,F.h,W.a,X.e,X.a,Z.a,Y.a,X.d,tt.b,tt.a,et.a],styles:[".example-form[_ngcontent-%COMP%]{min-width:150px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}button[_ngcontent-%COMP%]{background-color:#d7a312;color:#fff}.margin-btn[_ngcontent-%COMP%]{margin:0 20px 0 0}.label-align[_ngcontent-%COMP%]{width:100%;text-align:left}.example-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%}.example-radio-button[_ngcontent-%COMP%]{margin-left:10px}.example-radio-button-r[_ngcontent-%COMP%]{margin-left:30px}.text-red[_ngcontent-%COMP%]{color:red}.border-estado[_ngcontent-%COMP%]{border:3px solid #000;width:200px;padding:10px;color:#fff}.b-color-estado-r[_ngcontent-%COMP%]{background-color:red}.b-color-estado-g[_ngcontent-%COMP%]{background-color:green}.md-48[_ngcontent-%COMP%]{font-size:100px;color:red}.example-viewport[_ngcontent-%COMP%]{height:22vh;width:22vw;border:3px solid #000}.example-item[_ngcontent-%COMP%]{height:20px;padding-left:20px;padding-top:20px}.p-left[_ngcontent-%COMP%]{padding-left:10px}.text-inside-grid[_ngcontent-%COMP%]{position:absolute;left:5px}.checkbox-small-padding[_ngcontent-%COMP%]{padding-top:1.5em;padding-left:2em;padding-right:0}"]}),t})();class lt{constructor(){this.nombre="",this.departamento="",this.trabajador="",this.pcontrol="",this.estado=""}}let st=(()=>{class t{constructor(t,e){var o;t&&Object.assign(this,t),e&&(this.id=e.id,this.trabajadorId=e.trabajador.trab_id,this.proveedorId=null===(o=e.proveedor)||void 0===o?void 0:o.PROVEEDOR_ID,this.departamenteoId=e.departamento.id,this.puntoControlId=e.puntoControl.id,this.fechaInicio=e.fechaInicio,this.fechaFin=e.fechaFin,this.permiteAprobar=e.permiteAprobar,this.estadoId=e.estadoId,this.estadoSolicitud=e.estadoSolicitud,this.aprobacionJefeSolicita=e.aprobacionJefeSolicita,this.FECHA_APROB_JEF_SOLICITA_ID=e.fechaAprobacionJefeSolicita,this.aprobacionResponsablePuntoControl=e.aprobacionResponsablePuntoControl,this.FECHA_APROB_REF_PUNTO=e.fechaAprobacionResponsablePuntoControl,this.aprobacionJefedepartamento=e.aprobacionJefedepartamento,this.FECHA_APROB_JEF_DPTO=e.fechaAprobacionJefedepartamento,this.usuarioAnulacion=e.usuarioAnulacion,this.FECHA_ANULA=e.fechaAnulacion)}}return Object(D.b)([Object(R.e)()],t.prototype,"id",void 0),Object(D.b)([Object(R.e)()],t.prototype,"anio",void 0),Object(D.b)([Object(R.e)()],t.prototype,"ciaId",void 0),Object(D.b)([Object(R.e)(),Object(R.f)({message:"* Campo obligatorio."})],t.prototype,"fechaInicio",void 0),Object(D.b)([Object(R.e)(),Object(R.f)({message:"* Campo obligatorio."})],t.prototype,"fechaFin",void 0),Object(D.b)([Object(R.e)()],t.prototype,"estadoId",void 0),Object(D.b)([Object(R.e)()],t.prototype,"estadoSolicitud",void 0),Object(D.b)([Object(R.e)()],t.prototype,"motivo",void 0),Object(D.b)([Object(R.e)()],t.prototype,"proveedorId",void 0),Object(D.b)([Object(R.e)(),Object(R.f)({message:"* Campo obligatorio."})],t.prototype,"trabajadorId",void 0),Object(D.b)([Object(R.e)()],t.prototype,"departamenteoId",void 0),Object(D.b)([Object(R.e)()],t.prototype,"fechaEfectiva",void 0),Object(D.b)([Object(R.e)(),Object(R.f)({message:"* Campo obligatorio."})],t.prototype,"puntoControlId",void 0),Object(D.b)([Object(R.e)()],t.prototype,"aprobacionJefeSolicita",void 0),Object(D.b)([Object(R.e)()],t.prototype,"FECHA_APROB_JEF_SOLICITA_ID",void 0),Object(D.b)([Object(R.e)()],t.prototype,"aprobacionResponsablePuntoControl",void 0),Object(D.b)([Object(R.e)()],t.prototype,"FECHA_APROB_REF_PUNTO",void 0),Object(D.b)([Object(R.e)()],t.prototype,"aprobacionJefedepartamento",void 0),Object(D.b)([Object(R.e)()],t.prototype,"FECHA_APROB_JEF_DPTO",void 0),Object(D.b)([Object(R.e)()],t.prototype,"usuarioAnulacion",void 0),Object(D.b)([Object(R.e)()],t.prototype,"permiteAprobar",void 0),Object(D.b)([Object(R.e)()],t.prototype,"FECHA_ANULA",void 0),t})();var dt=o("bv9b"),bt=o("KZqF"),ut=o("1GFE");function pt(t,e){1&t&&n.Qb(0,"mat-progress-bar",10)}function mt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",11),n.dc("click",(function(){return n.Ac(t),n.hc().aprobar()})),n.Ic(1," Aprobar "),n.Ub()}if(2&t){const t=n.hc();n.Gb("spinner",t.loadingAprobar)}}function ht(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",12),n.dc("click",(function(){return n.Ac(t),n.hc().anular()})),n.Ic(1," Anular "),n.Ub()}if(2&t){const t=n.hc();n.Gb("spinner",t.loadingAnular)}}function gt(t,e){if(1&t&&(n.Vb(0,"mat-grid-list",15),n.Vb(1,"mat-radio-group",31),n.Vb(2,"mat-grid-tile",16),n.Qb(3,"label",32),n.Ub(),n.Vb(4,"mat-grid-tile",16),n.Vb(5,"div",17),n.Vb(6,"mat-radio-button",33),n.Ic(7,"Trabajador"),n.Ub(),n.Vb(8,"mat-radio-button",34),n.Ic(9,"Visita"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub()),2&t){const t=n.hc(2);n.nc("rowHeight",t.platformService.heightMatColumns()),n.Cb(2),n.nc("colspan",1),n.Cb(2),n.nc("colspan",4),n.Cb(2),n.nc("disabled",t.disabledForm),n.Cb(2),n.nc("disabled",t.disabledForm)}}const ft=function(t,e){return{"text-success":t,"text-danger":e}},Ct=function(t,e){return{"b-color-estado-g":t,"b-color-estado-r":e}};function St(t,e){if(1&t&&(n.Vb(0,"div"),n.Vb(1,"mat-grid-list",15),n.Vb(2,"mat-grid-tile",16),n.Vb(3,"p",17),n.Ic(4,"Estado:"),n.Ub(),n.Ub(),n.Vb(5,"mat-grid-tile",16),n.Qb(6,"pca-input-generic",35),n.Ub(),n.Ub(),n.Vb(7,"mat-grid-list",36),n.Vb(8,"mat-grid-tile",16),n.Vb(9,"div",37),n.Vb(10,"p"),n.Ic(11,"Jefatura que solicita"),n.Ub(),n.Vb(12,"p"),n.Ic(13),n.Ub(),n.Vb(14,"p"),n.Ic(15),n.ic(16,"date"),n.Ub(),n.Ub(),n.Ub(),n.Vb(17,"mat-grid-tile",16),n.Vb(18,"div",37),n.Vb(19,"p"),n.Ic(20,"Responsable de Control"),n.Ub(),n.Vb(21,"p"),n.Ic(22),n.Ub(),n.Vb(23,"p"),n.Ic(24),n.ic(25,"date"),n.Ub(),n.Ub(),n.Ub(),n.Vb(26,"mat-grid-tile",16),n.Vb(27,"div",37),n.Vb(28,"p"),n.Ic(29,"Jefatura de Departamento"),n.Ub(),n.Vb(30,"p"),n.Ic(31),n.Ub(),n.Vb(32,"p"),n.Ic(33),n.ic(34,"date"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub()),2&t){const t=n.hc(2);n.Cb(1),n.nc("rowHeight",t.platformService.heightMatColumns()),n.Cb(1),n.nc("colspan",1),n.Cb(3),n.nc("colspan",4),n.Cb(1),n.nc("label","Estado")("inputClass",n.sc(28,ft,!t.formSolicitudAcceso.get("usuarioAnulacion").value,t.formSolicitudAcceso.get("usuarioAnulacion").value))("readonly",!0),n.Cb(1),n.nc("rowHeight",t.platformService.heightMatColumns()),n.Cb(1),n.nc("colspan",1),n.Cb(1),n.nc("ngClass",n.sc(31,Ct,t.formSolicitudAcceso.get("aprobacionJefeSolicita").value,!t.formSolicitudAcceso.get("aprobacionJefeSolicita").value)),n.Cb(4),n.Kc("Usuario: ",t.formSolicitudAcceso.get("aprobacionJefeSolicita").value,""),n.Cb(2),n.Kc("Fecha: ",t.formSolicitudAcceso.get("aprobacionJefeSolicita").value?n.kc(16,19,t.formSolicitudAcceso.get("FECHA_APROB_JEF_SOLICITA_ID").value,"dd/MM/yyyy hh:mm a"):"",""),n.Cb(2),n.nc("colspan",1),n.Cb(1),n.nc("ngClass",n.sc(34,Ct,t.formSolicitudAcceso.get("aprobacionResponsablePuntoControl").value,!t.formSolicitudAcceso.get("aprobacionResponsablePuntoControl").value)),n.Cb(4),n.Kc("Usuario: ",t.formSolicitudAcceso.get("aprobacionResponsablePuntoControl").value,""),n.Cb(2),n.Kc("Fecha: ",t.formSolicitudAcceso.get("aprobacionResponsablePuntoControl").value?n.kc(25,22,t.formSolicitudAcceso.get("FECHA_APROB_REF_PUNTO").value,"dd/MM/yyyy hh:mm a"):"",""),n.Cb(2),n.nc("colspan",1),n.Cb(1),n.nc("ngClass",n.sc(37,Ct,t.formSolicitudAcceso.get("aprobacionJefedepartamento").value,!t.formSolicitudAcceso.get("aprobacionJefedepartamento").value)),n.Cb(4),n.Kc("Usuario: ",t.formSolicitudAcceso.get("aprobacionJefedepartamento").value,""),n.Cb(2),n.Kc("Fecha: ",t.formSolicitudAcceso.get("aprobacionJefedepartamento").value?n.kc(34,25,t.formSolicitudAcceso.get("FECHA_APROB_JEF_DPTO").value,"dd/MM/yyyy hh:mm a"):"","")}}function vt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"form",13),n.Gc(1,gt,10,5,"mat-grid-list",14),n.Vb(2,"mat-grid-list",15),n.Vb(3,"mat-grid-tile",16),n.Vb(4,"label",17),n.Ic(5,"* Solicitante: "),n.Ub(),n.Ub(),n.Vb(6,"mat-grid-tile",16),n.Vb(7,"pca-autocomplete-trabajador",18),n.dc("trabajadorSelected",(function(e){return n.Ac(t),n.hc().trabajadorSelected(e)})),n.Ub(),n.Ub(),n.Ub(),n.Vb(8,"mat-grid-list",15),n.Vb(9,"mat-grid-tile",16),n.Vb(10,"label",17),n.Ic(11,"Empresa: "),n.Ub(),n.Ub(),n.Vb(12,"mat-grid-tile",16),n.Qb(13,"pca-autocomplete-empresa",19),n.Ub(),n.Ub(),n.Vb(14,"mat-grid-list",15),n.Vb(15,"mat-grid-tile",16),n.Vb(16,"label",17),n.Ic(17,"Departamento: "),n.Ub(),n.Ub(),n.Vb(18,"mat-grid-tile",16),n.Vb(19,"pca-autocomplete-departamento",20),n.dc("departamentoSelected",(function(e){return n.Ac(t),n.hc().departamentoSelected(e)})),n.Ub(),n.Ub(),n.Ub(),n.Vb(20,"mat-grid-list",15),n.Vb(21,"mat-grid-tile",16),n.Vb(22,"label",17),n.Ic(23," * Punto de control: "),n.Ub(),n.Ub(),n.Vb(24,"mat-grid-tile",16),n.Qb(25,"pca-autocomplete-punto-control",21),n.Ub(),n.Ub(),n.Vb(26,"mat-grid-list",22),n.Vb(27,"mat-grid-tile",16),n.Vb(28,"mat-form-field",23),n.Vb(29,"mat-label"),n.Ic(30,"* Fecha inicio"),n.Ub(),n.Qb(31,"input",24),n.Qb(32,"mat-datepicker-toggle",25),n.Qb(33,"mat-datepicker",null,26),n.Ub(),n.Ub(),n.Vb(35,"mat-grid-tile",16),n.Vb(36,"mat-form-field",27),n.Vb(37,"mat-label"),n.Ic(38,"* Fecha fin"),n.Ub(),n.Qb(39,"input",28),n.Qb(40,"mat-datepicker-toggle",25),n.Qb(41,"mat-datepicker",null,29),n.Ub(),n.Ub(),n.Ub(),n.Gc(43,St,35,40,"div",30),n.Ub()}if(2&t){const t=n.xc(34),e=n.xc(42),o=n.hc();n.nc("formGroup",o.formSolicitudAcceso),n.Cb(1),n.nc("ngIf",!1),n.Cb(1),n.nc("rowHeight",o.platformService.heightMatColumns()),n.Cb(1),n.nc("colspan",1),n.Cb(3),n.nc("colspan",4),n.Cb(1),n.nc("required",!0)("readonly",o.formSolicitudAcceso.get("id").value&&o.formSolicitudAcceso.enabled)("label","Buscar nombre del solicitante..."),n.Cb(1),n.nc("rowHeight",o.platformService.heightMatColumns()),n.Cb(1),n.nc("colspan",1),n.Cb(3),n.nc("colspan",4),n.Cb(1),n.nc("disabled",o.disabledForm)("readonly",!0)("label",""),n.Cb(1),n.nc("rowHeight",o.platformService.heightMatColumns()),n.Cb(1),n.nc("colspan",1),n.Cb(3),n.nc("colspan",4),n.Cb(1),n.nc("readonly",!0)("label",""),n.Cb(1),n.nc("rowHeight",o.platformService.heightMatColumns()),n.Cb(1),n.nc("colspan",1),n.Cb(3),n.nc("colspan",4),n.Cb(1),n.nc("label","")("readonly",o.formSolicitudAcceso.get("id").value&&o.formSolicitudAcceso.enabled),n.Cb(1),n.nc("rowHeight",o.platformService.heightMatColumns()),n.Cb(1),n.nc("colspan",2),n.Cb(4),n.nc("max",o.formSolicitudAcceso.get("fechaFin").value||null)("matDatepicker",t),n.Cb(1),n.nc("for",t),n.Cb(3),n.nc("colspan",2),n.Cb(4),n.nc("min",o.formSolicitudAcceso.get("fechaInicio").value||null)("matDatepicker",e),n.Cb(1),n.nc("for",e),n.Cb(3),n.nc("ngIf",null==o.formSolicitudAcceso?null:o.formSolicitudAcceso.get("id").value)}}let At=(()=>{class t{constructor(t,e,o,i,a,c,n){this.dialogRef=t,this.data=e,this.fb=o,this.iSolicitudAccesoService=i,this.alertModalService=a,this.platformService=c,this.cSolicitudAccesoValidationService=n,this.titulo="Registrar solicitud de acceso",this.pendiente=!1,this.estados={estadoJS:!1,estadoRC:!1,estadoJD:!1,modificacion:!1},this.model=new lt,this.loadingSave=!1,this.loadingAnular=!1,this.loadingAprobar=!1,this.loadingForm=!1,this.disabledForm=!1,this.unsubscribe$=new g.a}ngOnInit(){this.verificarEditar(this.data),this.formBuilderSolicitudAcceso()}ngOnDestroy(){this.unsubscribe$.complete(),this.unsubscribe$.unsubscribe()}formBuilderSolicitudAcceso(){this.formSolicitudAcceso=this.fb.formGroup(new st),this.data&&this.data.solicitud&&this.data.solicitud.id&&this.obtenerSolicitudAccesoById(this.data.solicitud.id,this.data.solicitud.permiteAprobar)}allowApprovations(){return this.formSolicitudAcceso.get("permiteAprobar").value}getNivelRequeridoAprobacionSolicitud(){let t=this.cSolicitudAccesoValidationService.nivelActualSolicitud(this.formSolicitudAcceso.get("aprobacionJefeSolicita").value,this.formSolicitudAcceso.get("aprobacionResponsablePuntoControl").value,this.formSolicitudAcceso.get("aprobacionJefedepartamento").value);return t++,t}allowAnulled(){return this.cSolicitudAccesoValidationService.obtenerNivelEspecial(),this.formSolicitudAcceso.get("id").value&&this.formSolicitudAcceso.get("estadoId").value!==m.Anulado&&this.formSolicitudAcceso.get("estadoId").value!==m.SolicitudAprobada&&!this.formSolicitudAcceso.get("usuarioAnulacion").value}obtenerSolicitudAccesoById(t,e){this.loadingForm=!0,this.iSolicitudAccesoService.obtenerSolicitudesDeAccesoById(t).pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{this.loadingForm=!1,t&&(this.formSolicitudAcceso=this.fb.formGroup(new st(null,t)),this.formSolicitudAcceso.get("permiteAprobar").setValue(e),this.cSolicitudAccesoValidationService.nivelActualSolicitud(this.formSolicitudAcceso.get("aprobacionJefeSolicita").value,this.formSolicitudAcceso.get("aprobacionResponsablePuntoControl").value,this.formSolicitudAcceso.get("aprobacionJefedepartamento").value)>0&&this.formSolicitudAcceso.disable(),this.disabledForm=!0)})}verificarEditar(t){null!=t&&(this.titulo="Modificar Solicitud de acceso",this.estados.modificacion=!0,this.model.departamento=t.departamento,this.model.pcontrol=t.pcontrol)}closeForm(){this.dialogRef.close()}trabajadorSelected(t){this.formSolicitudAcceso.get("proveedorId").setValue(null==t?void 0:t.Empresa),this.formSolicitudAcceso.get("departamenteoId").setValue(null==t?void 0:t.departamentoId)}departamentoSelected(t){this.formSolicitudAcceso.get("fechaEfectiva").setValue(null==t?void 0:t.fechaEfectiva)}save(){this.formSolicitudAcceso.valid&&!this.loadingSave&&(this.loadingSave=!0,this.iSolicitudAccesoService.upsertSolicitudesDeAcceso(this.formSolicitudAcceso.value).pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{this.loadingSave=!1,t&&(this.dialogRef.close(!0),this.alertModalService.alert(h.a.success,"Registro guardado con \xe9xito."))}))}aprobar(){this.loadingAprobar=!0;const t=this.getNivelRequeridoAprobacionSolicitud();this.iSolicitudAccesoService.aprobarSolicitud(this.formSolicitudAcceso.get("id").value,t).pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{this.loadingAprobar=!1,t&&(this.dialogRef.close(!0),this.alertModalService.alert(h.a.success,"Aprobaci\xf3n realizada con \xe9xito."))})}anular(){this.loadingAnular=!0,this.iSolicitudAccesoService.anularSolicitud(this.formSolicitudAcceso.get("id").value).pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{this.loadingAnular=!1,t&&(this.dialogRef.close(!0),this.alertModalService.alert(h.a.success,"Anulaci\xf3n realizada con \xe9xito."))})}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(C.g),n.Pb(C.a),n.Pb(R.a),n.Pb(P),n.Pb(j.a),n.Pb(H.a),n.Pb(v))},t.\u0275cmp=n.Jb({type:t,selectors:[["pca-registrar-acceso"]],decls:17,vars:8,consts:[[1,"add-title"],[1,"primary",2,"text-align","left"],["mode","indeterminate",4,"ngIf"],[1,"btn-sec"],["mat-raised-button","","matTooltip","GUARDAR",1,"button-amarillo",3,"disabled","click"],[1,"material-icons"],["mat-raised-button","","matTooltip","APROBAR","class","button-amarillo",3,"spinner","click",4,"ngIf"],["mat-raised-button","","matTooltip","ANULAR","class","btn-danger margin-btn",3,"spinner","click",4,"ngIf"],["mat-flat-button","","mat-dialog-close","","matTooltip","CERRAR"],["class","example-form",3,"formGroup",4,"ngIf"],["mode","indeterminate"],["mat-raised-button","","matTooltip","APROBAR",1,"button-amarillo",3,"click"],["mat-raised-button","","matTooltip","ANULAR",1,"btn-danger","margin-btn",3,"click"],[1,"example-form",3,"formGroup"],["cols","5",3,"rowHeight",4,"ngIf"],["cols","5",3,"rowHeight"],[3,"colspan"],[1,"label-align"],["formControlName","trabajadorId",3,"required","readonly","label","trabajadorSelected"],["formControlName","proveedorId",3,"disabled","readonly","label"],["formControlName","departamenteoId",3,"readonly","label","departamentoSelected"],["formControlName","puntoControlId",3,"label","readonly"],["cols","4",3,"rowHeight"],["appearance","outline",1,"example-full-width","w-100","mr-1"],["matInput","","readonly","","formControlName","fechaInicio",3,"max","matDatepicker"],["matSuffix","",3,"for"],["picker2",""],["appearance","outline",1,"example-full-width","w-100"],["matInput","","readonly","","formControlName","fechaFin",3,"min","matDatepicker"],["picker",""],[4,"ngIf"],["id","radio","aria-labelledby","radio_tipo",1,"example-radio-group"],["id","radio_tipo",1,"label-align"],["value","1",1,"example-radio-button",3,"disabled"],["value","2",1,"example-radio-button-r",3,"disabled"],["formControlName","estadoSolicitud",3,"label","inputClass","readonly"],["cols","3",3,"rowHeight"],[1,"border-estado",3,"ngClass"]],template:function(t,e){1&t&&(n.Vb(0,"div"),n.Vb(1,"div",0),n.Vb(2,"h1",1),n.Ic(3),n.Ub(),n.Qb(4,"mat-divider"),n.Gc(5,pt,1,0,"mat-progress-bar",2),n.Ub(),n.Qb(6,"br"),n.Vb(7,"div",3),n.Vb(8,"button",4),n.dc("click",(function(){return e.save()})),n.Vb(9,"span",5),n.Ic(10,"save"),n.Ub(),n.Ub(),n.Gc(11,mt,2,2,"button",6),n.Gc(12,ht,2,2,"button",7),n.Vb(13,"button",8),n.Vb(14,"mat-icon"),n.Ic(15,"arrow_back"),n.Ub(),n.Ub(),n.Ub(),n.Gc(16,vt,44,34,"form",9),n.Ub()),2&t&&(n.Cb(3),n.Jc(e.titulo),n.Cb(2),n.nc("ngIf",e.loadingForm),n.Cb(3),n.Gb("spinner",e.loadingSave),n.nc("disabled",!e.formSolicitudAcceso.valid),n.Cb(3),n.nc("ngIf",e.allowApprovations()),n.Cb(1),n.nc("ngIf",e.allowAnulled()),n.Cb(4),n.nc("ngIf",!e.loadingForm))},directives:[y.a,i.m,x.b,w.a,C.d,_.a,dt.a,J.w,J.q,J.j,R.g,Q.a,Q.c,bt.a,J.p,J.h,R.k,R.h,J.u,B.a,q.a,ut.a,F.b,F.f,z.b,J.c,W.b,W.d,F.h,W.a,tt.b,tt.a,Y.a,i.k],pipes:[i.e],styles:[".example-form[_ngcontent-%COMP%]{min-width:150px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}.margin-btn[_ngcontent-%COMP%]{margin:0 20px 0 0}.label-align[_ngcontent-%COMP%]{width:100%;text-align:left}.example-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%}.example-radio-button[_ngcontent-%COMP%]{margin-left:10px}.example-radio-button-r[_ngcontent-%COMP%]{margin-left:30px}.text-red[_ngcontent-%COMP%]{color:red}.border-estado[_ngcontent-%COMP%]{border:3px solid #000;width:200px;padding:10px;color:#fff}.md-48[_ngcontent-%COMP%]{font-size:100px;color:red}"]}),t})();var It=function(t){return t.FormatoImportacion="Hoja3",t.MaestroTrabajador="Hoja2",t.MaestroPuntoControl="Hoja1",t}({}),Vt=o("LRne"),Ot=o("wd/R"),Ut=o("TA6j"),jt=o("eIep"),Pt=o("u/Yd");let xt=(()=>{class t{constructor(t,e,o){this.excelHelperService=t,this.caTrabajadorService=e,this.appSettings=o,this.maestroPuntoControl=[]}validationHeader(t){const e=[];if(t&&t.length){const o=Object.keys({DNI:"","Punto Control Id":"","Fecha Inicio":"","Fecha Fin":""}),i=Object.keys(t[0]);let a=0;for(const t of o)i[a]!==t&&e.push({line:1,message:`La cabecera "${i[a]}" deberia de cambiarse por "${t}".`}),a++}return e}columnsDataParams(){}validationColumns(t){var e,o;let i=null;const a=[];if(t&&t.length){const c=(null===(e=t.find(t=>t.sheetName===It.FormatoImportacion))||void 0===e?void 0:e.content)||[];this.maestroPuntoControl=(null===(o=t.find(t=>t.sheetName===It.MaestroPuntoControl))||void 0===o?void 0:o.content)||[];for(const t of c){if(t.DNI&&t.DNI.toString().length<8&&a.push({line:t.numLine,message:'El campo "DNI" no debe ser vac\xedo'}),t["Punto Control Id"]&&0===(""+t["Punto Control Id"]).trim().length?a.push({line:t.numLine,message:'El campo "Punto Control Id" no debe ser vac\xedo'}):this.maestroPuntoControl.some(e=>(""+e["Punto Control Codigo"]).trim()===(""+t["Punto Control Id"]).trim())||a.push({line:t.numLine,dato:t["C\xf3digo Dpto"],message:`El campo "Punto Control Codigo" contiene un Punto Control no registrado (Revisar Hoja: ${It.MaestroPuntoControl})`}),"number"==typeof t["Fecha Inicio"]){const e=d.a.getJsDateFromExcel(t["Fecha Inicio"]);t["Fecha Inicio"]=e?null:d.a.parseDateToShortString(e)}if(t["Fecha Inicio"]&&0===t["Fecha Inicio"].length?a.push({line:t.numLine,message:'Fecha Inicio" no debe ser vac\xedo'}):Ot(t["Fecha Inicio"],Ut.a.FORMAT_DATE_SHORT,!0).isValid()||a.push({line:t.numLine,dato:t["Fecha Inicio"],message:'El campo "Fecha Inicio" no tiene el formato v\xe1lido (DD/MM/AAAA)'}),"number"==typeof t["Fecha Fin"]){const e=d.a.getJsDateFromExcel(t["Fecha Fin"]);t["Fecha Fin"]=e?null:d.a.parseDateToShortString(e)}t["Fecha Fin"]&&0===t["Fecha Fin"].length?a.push({line:t.numLine,message:'Fecha Fin" no debe ser vac\xedo'}):Ot(t["Fecha Fin"],Ut.a.FORMAT_DATE_SHORT,!0).isValid()||a.push({line:t.numLine,dato:t["Fecha Fin"],message:'El campo "Fecha Fin" no tiene el formato v\xe1lido (DD/MM/AAAA)'})}i=a&&a.length?{errors:a}:{sheets:this.parseExcelSolicitudAcceso(c)}}return i}parseExcelSolicitudAcceso(t){let e=[];return t&&t.length&&(e=t.map(t=>({numLine:t.numLine,dniSolicitante:t.DNI,puntoControl:+(t["Punto Control Id"]||0),fechaInicio:Ot(t["Fecha Inicio"],Ut.a.FORMAT_DATE_SHORT).toDate(),fechaFin:Ot(t["Fecha Fin"],Ut.a.FORMAT_DATE_SHORT).toDate()}))),e}getDataExcel(t){return this.excelHelperService.readerExcel(t).pipe(Object(jt.a)(t=>{if(Array.isArray(t)&&t.length){const e=t.find(t=>t.sheetName===It.FormatoImportacion);if(e){const o=this.validationHeader(e.content);if(o&&o.length)return Object(Vt.a)({errors:o});{const e=this.validationColumns(t);return e&&e.errors&&e.errors.length?Object(Vt.a)({errors:e.errors}):this.validationDniImportados(e)}}return Object(Vt.a)({errors:[{line:0,message:"No existe la hoja: "+It.FormatoImportacion}]})}return Object(Vt.a)({errors:[{line:0,message:"No se logro leer el documento o est\xe1 vac\xedo."}]})}))}validationDniImportados(t){let e=t.sheets;const o=e.map(t=>""+t.dniSolicitante);return this.caTrabajadorService.consultaMasivamenteDnisTrabajador(o,this.appSettings.isIntranet?"":this.appSettings.proveedorId).pipe(Object(jt.a)(t=>{const o=[],i=t.reduce((t,e)=>(t[e.dni.trim()]=e,t),[]);return e=e.map(t=>(t.trabajador=i[(""+t.dniSolicitante).trim()],t)),e.filter(t=>!t.trabajador).forEach(t=>{o.push({line:t.numLine,dato:t.dniSolicitante,message:'El campo "DNI" tiene un Documento de indentidad no registrado'})}),o&&o.length?Object(Vt.a)({errors:o}):Object(Vt.a)({sheets:e})}))}}return t.\u0275fac=function(e){return new(e||t)(n.Zb(Pt.a),n.Zb(G.a),n.Zb(S.a))},t.\u0275prov=n.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var wt=o("7EHt");function _t(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",50),n.dc("click",(function(){return n.Ac(t),n.hc().aprobarMasivo()})),n.Ic(1," Aprobar "),n.Ub()}if(2&t){const t=n.hc();n.Gb("spinner",t.loadingAprobarMasivo),n.nc("disabled",!t.enableAprobation())}}function Ft(t,e){if(1&t){const t=n.Wb();n.Vb(0,"button",2),n.dc("click",(function(){return n.Ac(t),n.hc().notificarSolicitud()})),n.Ic(1," Notificar "),n.Ub()}if(2&t){const t=n.hc();n.Gb("spinner",t.loadingNotificar)}}function yt(t,e){1&t&&n.Qb(0,"pca-autocomplete-empresa",51)}function Tt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"mat-header-cell",52),n.Vb(1,"mat-checkbox",53),n.dc("change",(function(e){n.Ac(t);const o=n.hc();return e?o.masterToggle():null})),n.Ub(),n.Ub()}if(2&t){const t=n.hc();n.nc("ngClass","mat-column-check"),n.Cb(1),n.nc("checked",t.selection.hasValue()&&t.isAllSelected())("indeterminate",t.selection.hasValue()&&!t.isAllSelected())("aria-label",t.checkboxLabel())}}function Mt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"mat-cell",52),n.Vb(1,"section",54),n.Vb(2,"mat-checkbox",55),n.dc("click",(function(e){return n.Ac(t),e.stopPropagation()}))("change",(function(o){n.Ac(t);const i=e.$implicit,a=n.hc();return o?a.selection.toggle(i):null})),n.Ub(),n.Ub(),n.Ub()}if(2&t){const t=e.$implicit,o=n.hc();n.nc("ngClass","mat-column-check"),n.Cb(2),n.nc("checked",o.selection.isSelected(t))("aria-label",o.checkboxLabel(t))}}function kt(t,e){1&t&&(n.Vb(0,"mat-header-cell",56),n.Ic(1," Id "),n.Ub())}function Et(t,e){if(1&t&&(n.Vb(0,"mat-cell",57),n.Ic(1),n.Ub()),2&t){const t=e.$implicit;n.Cb(1),n.Kc(" ",t.id," ")}}function Dt(t,e){1&t&&(n.Vb(0,"mat-header-cell",58),n.Ic(1," Empresa "),n.Ub())}function Rt(t,e){if(1&t&&(n.Vb(0,"mat-cell"),n.Ic(1),n.Ub()),2&t){const t=e.$implicit;n.Cb(1),n.Kc(" ",t.empresa," ")}}function $t(t,e){1&t&&(n.Vb(0,"mat-header-cell",58),n.Ic(1," Nombre "),n.Ub())}function Nt(t,e){if(1&t&&(n.Vb(0,"mat-cell"),n.Ic(1),n.Ub()),2&t){const t=e.$implicit;n.Cb(1),n.Kc(" ",t.trabajador.NOANX," ")}}function Gt(t,e){1&t&&(n.Vb(0,"mat-header-cell",58),n.Ic(1," Departamento "),n.Ub())}function Lt(t,e){if(1&t&&(n.Vb(0,"mat-cell"),n.Ic(1),n.Ub()),2&t){const t=e.$implicit;n.Cb(1),n.Kc(" ",t.departamento.nombre," ")}}function Ht(t,e){1&t&&(n.Vb(0,"mat-header-cell",59),n.Ic(1," Punto Control "),n.Ub()),2&t&&n.nc("ngClass","mat-column-puntocontrol")}function Jt(t,e){if(1&t&&(n.Vb(0,"mat-cell",60),n.Ic(1),n.Ub()),2&t){const t=e.$implicit;n.nc("ngClass","mat-column-puntocontrol"),n.Cb(1),n.Kc(" ",t.puntoControl.nombre," ")}}function Qt(t,e){1&t&&(n.Vb(0,"mat-header-cell",59),n.Ic(1," Estado "),n.Ub()),2&t&&n.nc("ngClass","mat-column-estado")}const Bt=function(t,e){return{"text-success":t,"text-danger":e}};function qt(t,e){if(1&t&&(n.Vb(0,"mat-cell",60),n.Vb(1,"span",60),n.Ic(2),n.Ub(),n.Ub()),2&t){const t=e.$implicit;n.nc("ngClass","mat-column-estado"),n.Cb(1),n.nc("ngClass",n.sc(3,Bt,!t.usuarioAnulacion,t.usuarioAnulacion)),n.Cb(1),n.Kc(" ",t.estadoSolicitud," ")}}function Kt(t,e){1&t&&(n.Vb(0,"mat-header-cell",60),n.Ic(1," Acci\xf3n "),n.Ub()),2&t&&n.nc("ngClass","mat-column-estado")}function zt(t,e){if(1&t){const t=n.Wb();n.Vb(0,"mat-cell",60),n.Vb(1,"mat-icon",61),n.dc("click",(function(){n.Ac(t);const o=e.$implicit;return n.hc().editarRegistro(o)})),n.Ic(2,"edit"),n.Ub(),n.Ub()}2&t&&n.nc("ngClass","mat-column-estado")}function Wt(t,e){1&t&&n.Qb(0,"mat-header-row")}const Xt=function(t){return{"disabled-text":t}};function Zt(t,e){if(1&t&&n.Qb(0,"mat-row",60),2&t){const t=e.$implicit,o=n.hc();n.nc("ngClass",n.rc(1,Xt,!o.aprobarFilaSolicitud(t)))}}function Yt(t,e){1&t&&(n.Vb(0,"div",62),n.Qb(1,"mat-progress-spinner",63),n.Ub())}function te(t,e){1&t&&(n.Vb(0,"mat-header-cell",64),n.Ic(1," L\xednea "),n.Ub())}function ee(t,e){if(1&t&&(n.Vb(0,"mat-cell",65),n.Ic(1),n.Ub()),2&t){const t=e.$implicit;n.Cb(1),n.Kc(" ",t.line," ")}}function oe(t,e){1&t&&(n.Vb(0,"mat-header-cell",66),n.Ic(1," Dato "),n.Ub())}function ie(t,e){if(1&t&&(n.Vb(0,"mat-cell",67),n.Ic(1),n.Ub()),2&t){const t=e.$implicit;n.Cb(1),n.Kc(" ",t.dato," ")}}function ae(t,e){1&t&&(n.Vb(0,"mat-header-cell",58),n.Ic(1," Mensaje "),n.Ub())}function ce(t,e){if(1&t&&(n.Vb(0,"mat-cell"),n.Ic(1),n.Ub()),2&t){const t=e.$implicit;n.Cb(1),n.Kc(" ",t.message," ")}}function ne(t,e){1&t&&n.Qb(0,"mat-header-row")}function re(t,e){1&t&&n.Qb(0,"mat-row")}const le=function(){return[10,20,50,100]},se=[{path:"",component:(()=>{class t{constructor(t,e,o,i,a,r,l,d){this.dialog=t,this.iSolicitudAccesoService=e,this.alertModalService=o,this.cSolicitudAccesoValidationService=i,this.platformService=a,this.iSolicitudAccesoInternal=r,this.appSettings=l,this.fb=d,this.paginator=new n.E,this.sort=new n.E,this.dataSource=new s.k([]),this.displayedColumns=p,this.selection=new c.c(!0,[]),this.loadingTable=!1,this.loadingAprobarMasivo=!1,this.loadingAnularMasivo=!1,this.loadingDownloadFile=!1,this.loadingNotificar=!1,this.loadingImportFile=!1,this.dataSourceErrors=new s.k,this.displayedColumnsError=u.a,this.nivelUser=[],this.unsubscribe$=new g.a}ngOnInit(){this.formFiltros=this.fb.group({proveedorId:[""],departamentoId:[""],puntoControlId:[""]}),this.nivelUser=this.cSolicitudAccesoValidationService.obtenerNivelEspecial()}settingTable(){this.dataSource.paginator=this.paginator.toArray()[0],this.dataSource.sort=this.sort.toArray()[0],this.dataSourceErrors.paginator=this.paginator.toArray()[1],this.dataSourceErrors.sort=this.sort.toArray()[1]}ngAfterViewInit(){this.settingTable()}ngOnDestroy(){this.unsubscribe$.complete(),this.unsubscribe$.unsubscribe()}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(t=>this.selection.select(t))}allowApprovations(){return this.nivelUser.length>0}getNivelRequeridoAprobacionSolicitud(t){let e=this.cSolicitudAccesoValidationService.nivelActualSolicitud(t.aprobacionJefeSolicita,t.aprobacionResponsablePuntoControl,t.aprobacionJefedepartamento);return e++,e}enableAprobation(){let t=!1;if(this.selection.hasValue()){const e=this.selection.selected;for(const o of e)if(t=this.aprobarFilaSolicitud(o),!t)break}return t}aprobarFilaSolicitud(t){return t.permiteAprobar}enableAnulled(){let t=!1;if(this.selection.hasValue()){const e=this.selection.selected;for(const o of e){if(o.estadoId===m.SolicitudAprobada||o.estadoId===m.Anulado||o.usuarioAnulacion){t=!1;break}t=!0}}return t}checkboxLabel(t){return t?`${this.selection.isSelected(t)?"deselect":"select"} row ${t.id+1}`:(this.isAllSelected()?"select":"deselect")+" all"}nuevoRegistro(){this.dialog.open(At,{width:"50vw",height:"70vh",disableClose:!0}).afterClosed().pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{t&&this.obtenerSolicitudAcceso()})}editarRegistro(t){this.dialog.open(At,{width:"50vw",height:"90vh",disableClose:!0,data:{solicitud:t}}).afterClosed().pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{t&&this.obtenerSolicitudAcceso()})}registroMasivo(){this.dialog.open(rt,{width:"50vw",height:"80vh"}).afterClosed().pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{t&&this.obtenerSolicitudAcceso()})}obtenerSolicitudAcceso(){const t=this.formFiltros.value||{};this.selection&&this.selection.clear(),this.loadingTable=!0,this.dataSource.data=[],t.niveles=this.obtenerNivelesUsuario(),this.iSolicitudAccesoService.obtenerSolicitudesDeAcceso(t).pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{this.loadingTable=!1,this.dataSource.data=t})}obtenerNivelesUsuario(){let t=this.appSettings.optionsSpecialAccess;return t&&t.length&&(t=t.filter(t=>t.TIPO_MOV_ADICIONAL&&t.TIPO_MOV.trim()===b.SPECIAL_SOLICIUD_ACCESO)),(t||[]).map(t=>+t.ESPECIAL_ID).join(",")||""}aprobarMasivo(){!this.loadingAprobarMasivo&&this.selection.selected&&this.selection.selected.length&&this.dialog.open(E,{width:"50vw",height:"80vh",data:{title:"Proceso de aprobaci\xf3n multiple",accionAprobacion:!0,items:this.selection.selected}}).afterClosed().pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{t&&this.obtenerSolicitudAcceso()})}anularMasivo(){!this.loadingAnularMasivo&&this.selection.selected&&this.selection.selected.length&&this.dialog.open(E,{width:"50vw",height:"80vh",data:{title:"Proceso de anulaci\xf3n multiple",items:this.selection.selected}}).afterClosed().pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{t&&this.obtenerSolicitudAcceso()})}downloadFormato(){this.loadingDownloadFile||(this.loadingDownloadFile=!0,this.iSolicitudAccesoService.obtenerSerializadoFormatoImportacion().pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{this.loadingDownloadFile=!1,t&&d.a.saveAsExcelFile(t,"formato_importacion_solicitud_accesos.xlsx")}))}selectFile(t){this.dataSourceErrors.data=[],this.loadingImportFile=!0,this.iSolicitudAccesoInternal.getDataExcel(t.target.files[0]).pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{t.sheets?this.iSolicitudAccesoService.importMasivoSolicitudAcceso(t.sheets).pipe(Object(f.a)(this.unsubscribe$)).subscribe(t=>{this.loadingImportFile=!1,t&&(this.alertModalService.alert(h.a.success,"El archivo se ha cargado con \xe9xito."),this.obtenerSolicitudAcceso())}):(this.loadingImportFile=!1,this.dataSourceErrors.data=t.errors,this.alertModalService.alert(h.a.error,"Archivo con errores, revisar en la secci\xf3n correspondiente."))})}notificarSolicitud(){if(!this.loadingNotificar&&this.selection.selected&&this.selection.selected.length){this.loadingNotificar=!0;let t=0;for(const e of this.selection.selected)this.iSolicitudAccesoService.notificarSolicitud(e.id).pipe(Object(f.a)(this.unsubscribe$)).subscribe(e=>{t++,this.selection.selected.length===t&&(this.loadingNotificar=!1,this.alertModalService.alert(h.a.success,"Notificacion enviada con \xe9xito"),this.obtenerSolicitudAcceso())},()=>this.loadingNotificar=!1)}}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(C.b),n.Pb(P),n.Pb(j.a),n.Pb(v),n.Pb(H.a),n.Pb(xt),n.Pb(S.a),n.Pb(J.e))},t.\u0275cmp=n.Jb({type:t,selectors:[["pca-isa-list"]],viewQuery:function(t,e){var o;1&t&&(n.Nc(r.a,!0),n.Nc(l.a,!0)),2&t&&(n.wc(o=n.ec())&&(e.paginator=o),n.wc(o=n.ec())&&(e.sort=o))},decls:87,vars:26,consts:[[1,"add-title"],[1,"mb-3"],["mat-raised-button","","type","submit",1,"btn-def","btn-margin-def","button-amarillo",3,"click"],["matTooltip","Agregar"],["mat-raised-button","","type","submit","class","btn-def btn-margin-def button-amarillo",3,"spinner","disabled","click",4,"ngIf"],["mat-raised-button","","type","submit",1,"btn-margin-def","btn-danger",3,"disabled","click"],["mat-raised-button","","type","submit","class","btn-def btn-margin-def button-amarillo",3,"spinner","click",4,"ngIf"],["matTooltip","Descargar formato de importaci\xf3n"],["matTooltip","Importar solicitudes"],["hidden","","type","file","name","import","accept",".xlsx,.xlx","onclick","this.value=null",3,"change"],["inputFile",""],["multi","",1,"example-headers-align"],[3,"formGroup"],["formControlName","proveedorId","class","generic-button-small w-25",4,"ngIf"],["formControlName","departamentoId",1,"generic-button-small","w-25",3,"usuario","niveles"],["formControlName","puntoControlId",1,"generic-button-small","w-25"],["mat-flat-button","","matTooltip","BUSCAR",1,"button-amarillo","btn-flex-custom",3,"click"],["matSort","",1,"mat-elevation-z8","table-margin-top",3,"dataSource"],["matColumnDef","select"],["style","max-width: 80px;padding-left:0;",3,"ngClass",4,"matHeaderCellDef"],["style","max-width: 80px;padding-left:0;",3,"ngClass",4,"matCellDef"],["matColumnDef","id"],["mat-sort-header","","style","max-width: 80px;",4,"matHeaderCellDef"],["style","max-width: 80px;",4,"matCellDef"],["matColumnDef","empresa"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","trabajador.NOANX"],["matColumnDef","departamento.nombre"],["matColumnDef","puntoControl.nombre"],["mat-sort-header","",3,"ngClass",4,"matHeaderCellDef"],[3,"ngClass",4,"matCellDef"],["matColumnDef","estado"],["matColumnDef","action"],[3,"ngClass",4,"matHeaderCellDef"],[4,"matHeaderRowDef"],[3,"ngClass",4,"matRowDef","matRowDefColumns"],["class","container-spinner-loading",4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],[1,"primary",2,"text-align","left",3,"hidden"],[1,"mat-elevation-z8",3,"hidden"],["matSort","",3,"dataSource"],["matColumnDef","line"],["mat-sort-header","","style","max-width: 150px;",4,"matHeaderCellDef"],["style","max-width: 150px;",4,"matCellDef"],["matColumnDef","dato"],["mat-sort-header","","style","max-width: 200px;",4,"matHeaderCellDef"],["style","max-width: 200px;",4,"matCellDef"],["matColumnDef","mensaje"],[4,"matRowDef","matRowDefColumns"],["mat-raised-button","","type","submit",1,"btn-def","btn-margin-def","button-amarillo",3,"disabled","click"],["formControlName","proveedorId",1,"generic-button-small","w-25"],[2,"max-width","80px","padding-left","0",3,"ngClass"],[3,"checked","indeterminate","aria-label","change"],[1,"example-section"],[3,"checked","aria-label","click","change"],["mat-sort-header","",2,"max-width","80px"],[2,"max-width","80px"],["mat-sort-header",""],["mat-sort-header","",3,"ngClass"],[3,"ngClass"],["matTooltip","Editar",1,"table-btn-editar",3,"click"],[1,"container-spinner-loading"],["color","primary","mode","indeterminate"],["mat-sort-header","",2,"max-width","150px"],[2,"max-width","150px"],["mat-sort-header","",2,"max-width","200px"],[2,"max-width","200px"]],template:function(t,e){if(1&t){const t=n.Wb();n.Vb(0,"div"),n.Vb(1,"div",0),n.Vb(2,"h2"),n.Ic(3," SOLICITUD DE ACCESO"),n.Ub(),n.Qb(4,"mat-divider"),n.Ub(),n.Vb(5,"div",1),n.Vb(6,"button",2),n.dc("click",(function(){return e.nuevoRegistro()})),n.Vb(7,"mat-icon",3),n.Ic(8,"add"),n.Ub(),n.Ub(),n.Vb(9,"button",2),n.dc("click",(function(){return e.registroMasivo()})),n.Ic(10," Registro Masivo "),n.Ub(),n.Gc(11,_t,2,3,"button",4),n.Vb(12,"button",5),n.dc("click",(function(){return e.anularMasivo()})),n.Ic(13," Anular "),n.Ub(),n.Gc(14,Ft,2,2,"button",6),n.Vb(15,"button",2),n.dc("click",(function(){return e.downloadFormato()})),n.Ic(16," Generar Formato "),n.Vb(17,"mat-icon",7),n.Ic(18,"download"),n.Ub(),n.Ub(),n.Vb(19,"button",2),n.dc("click",(function(){return n.Ac(t),n.xc(24).click()})),n.Ic(20," Importar "),n.Vb(21,"mat-icon",8),n.Ic(22,"upload"),n.Ub(),n.Vb(23,"input",9,10),n.dc("change",(function(t){return e.selectFile(t)})),n.Ub(),n.Ub(),n.Ub(),n.Vb(25,"mat-accordion",11),n.Vb(26,"mat-expansion-panel"),n.Vb(27,"mat-expansion-panel-header"),n.Vb(28,"mat-panel-title"),n.Ic(29," Filtros "),n.Ub(),n.Vb(30,"mat-panel-description"),n.Ic(31," Criterios de consulta "),n.Vb(32,"mat-icon"),n.Ic(33,"remove_red_eye"),n.Ub(),n.Ub(),n.Ub(),n.Vb(34,"form",12),n.Gc(35,yt,1,0,"pca-autocomplete-empresa",13),n.Qb(36,"pca-autocomplete-departamento",14),n.Qb(37,"pca-autocomplete-punto-control",15),n.Vb(38,"button",16),n.dc("click",(function(){return e.obtenerSolicitudAcceso()})),n.Vb(39,"mat-icon"),n.Ic(40,"search"),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Vb(41,"mat-table",17),n.Tb(42,18),n.Gc(43,Tt,2,4,"mat-header-cell",19),n.Gc(44,Mt,3,3,"mat-cell",20),n.Sb(),n.Tb(45,21),n.Gc(46,kt,2,0,"mat-header-cell",22),n.Gc(47,Et,2,1,"mat-cell",23),n.Sb(),n.Tb(48,24),n.Gc(49,Dt,2,0,"mat-header-cell",25),n.Gc(50,Rt,2,1,"mat-cell",26),n.Sb(),n.Tb(51,27),n.Gc(52,$t,2,0,"mat-header-cell",25),n.Gc(53,Nt,2,1,"mat-cell",26),n.Sb(),n.Tb(54,28),n.Gc(55,Gt,2,0,"mat-header-cell",25),n.Gc(56,Lt,2,1,"mat-cell",26),n.Sb(),n.Tb(57,29),n.Gc(58,Ht,2,1,"mat-header-cell",30),n.Gc(59,Jt,2,2,"mat-cell",31),n.Sb(),n.Tb(60,32),n.Gc(61,Qt,2,1,"mat-header-cell",30),n.Gc(62,qt,3,6,"mat-cell",31),n.Sb(),n.Tb(63,33),n.Gc(64,Kt,2,1,"mat-header-cell",34),n.Gc(65,zt,3,1,"mat-cell",31),n.Sb(),n.Gc(66,Wt,1,0,"mat-header-row",35),n.Gc(67,Zt,1,3,"mat-row",36),n.Ub(),n.Gc(68,Yt,2,0,"div",37),n.Qb(69,"mat-paginator",38),n.Ub(),n.Qb(70,"br"),n.Vb(71,"h2",39),n.Ic(72,"Errores"),n.Ub(),n.Vb(73,"div",40),n.Vb(74,"mat-table",41),n.Tb(75,42),n.Gc(76,te,2,0,"mat-header-cell",43),n.Gc(77,ee,2,1,"mat-cell",44),n.Sb(),n.Tb(78,45),n.Gc(79,oe,2,0,"mat-header-cell",46),n.Gc(80,ie,2,1,"mat-cell",47),n.Sb(),n.Tb(81,48),n.Gc(82,ae,2,0,"mat-header-cell",25),n.Gc(83,ce,2,1,"mat-cell",26),n.Sb(),n.Gc(84,ne,1,0,"mat-header-row",35),n.Gc(85,re,1,0,"mat-row",49),n.Ub(),n.Qb(86,"mat-paginator",38),n.Ub()}2&t&&(n.Cb(11),n.nc("ngIf",e.allowApprovations()),n.Cb(1),n.Gb("spinner",e.loadingAnularMasivo),n.nc("disabled",!e.enableAnulled()),n.Cb(2),n.nc("ngIf",e.appSettings.isIntranet),n.Cb(1),n.Gb("spinner",e.loadingDownloadFile),n.Cb(4),n.Gb("spinner",e.loadingImportFile),n.Cb(15),n.nc("formGroup",e.formFiltros),n.Cb(1),n.nc("ngIf",e.appSettings.isIntranet),n.Cb(1),n.nc("usuario",e.appSettings.isIntranet?e.appSettings.currentUser:"@")("niveles",e.appSettings.isIntranet?e.obtenerNivelesUsuario():"@"),n.Cb(5),n.nc("dataSource",e.dataSource),n.Cb(25),n.nc("matHeaderRowDef",e.displayedColumns),n.Cb(1),n.nc("matRowDefColumns",e.displayedColumns),n.Cb(1),n.nc("ngIf",e.loadingTable),n.Cb(1),n.nc("pageSizeOptions",n.qc(24,le)),n.Cb(2),n.nc("hidden",!e.dataSourceErrors||0==e.dataSourceErrors.data.length),n.Cb(2),n.nc("hidden",!e.dataSourceErrors||0==e.dataSourceErrors.data.length),n.Cb(1),n.nc("dataSource",e.dataSourceErrors),n.Cb(10),n.nc("matHeaderRowDef",e.displayedColumnsError),n.Cb(1),n.nc("matRowDefColumns",e.displayedColumnsError),n.Cb(1),n.nc("pageSizeOptions",n.qc(25,le)))},directives:[y.a,x.b,_.a,w.a,i.m,R.i,R.j,wt.a,wt.c,wt.e,wt.f,wt.d,J.w,J.q,J.j,R.g,q.a,J.p,J.h,R.k,R.h,ut.a,s.j,l.a,s.c,s.e,s.b,s.g,s.i,r.a,B.a,s.d,i.k,Z.a,s.a,l.b,s.f,s.h,et.a],styles:[".btn-margin-def[_ngcontent-%COMP%]{margin-right:20px;margin-top:10px}.table-margin-top[_ngcontent-%COMP%]{margin-top:20px}.mat-header-cell[_ngcontent-%COMP%]{flex-direction:column;justify-content:center}.mat-cell[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-estado[_ngcontent-%COMP%]{max-width:95px}.mat-column-puntocontrol[_ngcontent-%COMP%]{max-width:220px}.mat-column-accion[_ngcontent-%COMP%]{max-width:95px}.mat-column-check[_ngcontent-%COMP%]{max-width:85px}.w-25[_ngcontent-%COMP%]{width:25%!important}.disabled-text[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .disabled-text[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{color:#b3b3b3!important}"]}),t})()}];let de=(()=>{class t{}return t.\u0275mod=n.Nb({type:t}),t.\u0275inj=n.Mb({factory:function(e){return new(e||t)},imports:[[a.d.forChild(se)],a.d]}),t})();var be=o("PCNd"),ue=o("fawr"),pe=o("xf9H");let me=(()=>{class t{}return t.\u0275mod=n.Nb({type:t}),t.\u0275inj=n.Mb({factory:function(e){return new(e||t)},imports:[[i.c,be.a,J.k,J.t,R.b,de,ue.a,pe.a,J.k,J.t,R.b]]}),t})()}}]);